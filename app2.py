import streamlit as st
import pandas as pd

# 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤ App
st.set_page_config(page_title="STS - Student Tracking System", layout="wide")

# 2. ‡∏™‡πà‡∏ß‡∏ô Header ‡∏Ç‡∏≠‡∏á Application
st.title("üìå ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (STS)")
st.subheader("‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á Application: ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏• ‡∏ö‡∏∏‡∏ç‡∏ä‡∏¥‡∏ï")
st.markdown("---")

# 3. ‡∏™‡πà‡∏ß‡∏ô Dashboard (Cards)
# ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
total, handed_in, pending = 57, 29, 28

col1, col2, col3 = st.columns(3)
with col1:
    st.metric("‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Total)", f"{total} ‡∏Ñ‡∏ô")
with col2:
    st.metric("‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Handed in)", f"{handed_in} ‡∏Ñ‡∏ô", delta="51%")
with col3:
    st.metric("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á (Not submitted)", f"{pending} ‡∏Ñ‡∏ô", delta="-49%", delta_color="inverse")

st.markdown("---")

# 4. ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
st.header("üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô")

# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ pd.read_csv ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
data = {
    "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà": [7, 12, 3, 13, 21],
    "‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•": ["‡∏ô‡∏≤‡∏¢‡∏®‡∏¥‡∏£‡∏ß‡∏¥‡∏ä ‡πÄ‡∏Å‡∏©‡∏£", "‡∏î.‡∏ç.‡∏ì‡∏±‡∏ê‡∏ì‡∏¥‡∏ä‡∏≤ ‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤", "‡∏î.‡∏ä.‡∏ï‡∏£‡∏µ‡∏ì‡∏£‡∏á‡∏Ñ‡πå ‡πÄ‡∏™‡πâ‡∏ô‡∏™‡∏∏‡∏Ç", "‡∏î.‡∏ç.‡∏Ç‡∏ß‡∏±‡∏ç‡∏ä‡∏µ‡∏ß‡∏≤ ‡∏™‡∏∏‡∏Ç‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê", "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏†‡∏¥‡∏™‡∏£‡∏≤ ‡∏ó‡∏≤‡∏ô‡∏∞‡∏°‡∏±‡∏¢"],
    "‡∏Å‡∏•‡∏∏‡πà‡∏°": ["‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 1", "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 1", "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 3", "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 2", "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 1"],
    "1.1 ‡∏õ‡∏Å": ["‚úÖ", "‚úÖ", "‚úÖ", "‚ùå", "‚úÖ"],
    "1.2 ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå": ["‚úÖ", "‚úÖ", "‚ùå", "‚úÖ", "‚úÖ"],
    "1.4 ‡πÇ‡∏õ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå": ["‚úÖ", "‚ùå", "‚ùå", "‚úÖ", "‚úÖ"],
    "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": ["‡∏Ñ‡∏£‡∏ö", "‡∏Ñ‡πâ‡∏≤‡∏á 1.4", "‡∏Ñ‡πâ‡∏≤‡∏á 1.2, 1.4", "‡∏Ñ‡πâ‡∏≤‡∏á 1.1", "‡∏Ñ‡∏£‡∏ö"]
}
df = pd.DataFrame(data)

# ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Filter)
search = st.text_input("‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:")
if search:
    df = df[df['‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•'].str.contains(search) | df['‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà'].astype(str).contains(search)]

# ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Interactive
st.dataframe(df, use_container_width=True)

# 5. ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
st.markdown("### üõ† ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£")
col_btn1, col_btn2 = st.columns(2)
with col_btn1:
    if st.button("üîî ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (LINE)"):
        st.success("‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß!")
with col_btn2:
    # ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
    csv = df.to_csv(index=False).encode('utf-8-sig')
    st.download_button(
        label="üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (CSV)",
        data=csv,
        file_name='STS_Report.csv',
        mime='text/csv',
    )
